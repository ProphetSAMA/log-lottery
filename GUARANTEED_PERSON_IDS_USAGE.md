# 保底人员功能使用说明

## 功能概述

本功能允许您手动指定特定人员的编号（uid），使其在下一次抽奖中获得保底中奖机会，无需等待连续未中奖次数达到阈值。

## 使用方法

### 1. 进入配置页面

1. 打开应用
2. 点击"全局配置"
3. 找到"功能设置"（Ability Setting）区域

### 2. 启用保底匹配

确保"保底匹配"（Guaranteed Match）选项已启用（复选框已勾选）。

### 3. 添加保底人员编号

在"保底人员编号"（Guaranteed Person IDs）输入框中，输入您想要保底的人员编号（uid）。

**输入格式：**
- 多个编号用英文逗号分隔
- 示例：`U001,U002,U003`
- 支持空格，系统会自动去除

**示例：**
```
U001,U002,U003
```
或
```
U001, U002, U003
```

### 4. 保存配置

输入后，配置会自动保存。

## 优先级规则

当启用保底匹配功能时，抽奖系统会按以下优先级选择中奖人员：

1. **第一优先级**：手动指定的保底人员（通过"保底人员编号"设置）
2. **第二优先级**：自动保底人员（连续未中奖次数达到"保底阈值"的人员）
3. **第三优先级**：从剩余人员池中随机抽取

## 注意事项

1. **编号必须存在**：输入的人员编号（uid）必须在人员列表中存在，否则会被忽略
2. **自动清除**：建议每次抽奖后清空保底人员编号，避免重复使用
3. **配合阈值**：手动保底和自动保底可以同时使用
4. **数量限制**：如果保底人员数量超过本次抽奖人数，系统会按优先级选择

## 使用场景

### 场景1：特殊照顾
某些人员因特殊原因需要在本次抽奖中必须中奖：
```
输入：U001,U005
```

### 场景2：补偿机制
上次抽奖因为技术问题未能参与的人员：
```
输入：U010,U020,U030
```

### 场景3：结合自动保底
- 设置保底阈值：5次
- 设置保底人员编号：U001,U002
- 结果：U001、U002会首先中奖，然后是连续未中5次的人员，最后是随机抽取

## 示例配置

```
保底匹配（Guaranteed Match）: ✅ 启用
保底阈值（Guaranteed Threshold）: 5
保底人员编号（Guaranteed Person IDs）: U001,U002,U003
```

## 技术实现

- 配置存储在 localStorage 中，刷新页面后仍然保留
- 支持中英文界面
- 输入的编号会自动去除空格并按逗号分割

## 常见问题

**Q: 输入的编号不生效怎么办？**  
A: 请检查：
1. 编号格式是否正确（用英文逗号分隔）
2. 编号是否在人员列表中存在
3. 保底匹配功能是否已启用

**Q: 可以输入多少个编号？**  
A: 理论上没有限制，但建议不要超过本次抽奖的总人数。

**Q: 保底人员中奖后需要手动清除编号吗？**  
A: 建议每次抽奖后手动清空，系统不会自动清除。

## 相关文件

- 配置存储：`src/store/globalConfig.ts`
- UI 组件：`src/views/Config/Global/FaceConfig/parts/AbilitySetting.vue`
- 抽奖逻辑：`src/views/Home/useViewModel.ts`
- 测试文件：`__test__/GuaranteedMatching.test.ts`
